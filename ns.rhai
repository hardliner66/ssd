fn begin(name) {
    "// BEGIN " ++ name ++ NL
}

fn end(name) {
    "// END " ++ name ++ NL(2)
}

"//" ++ " THIS FILE IS AUTOMATICALLY GENERATED. DO NOT EDIT!!!";

"namespace " ++ model.name.join(".") ++ " {" ++ NL(2);

begin("INCLUDES");
for imp in model.imports {
    "include <" ++ imp.path.join("/") ++ ">" ++ NL
}
end("DATATYPES");

-(NL);

begin("DATATYPES");

for data_type in model.data_types {
    "struct " ++ data_type.name ++ " {" ++ NL;
        for property in data_type.properties {
            IND ++ property.typ.join("::") ++ " " ++ property.name ++ ";" ++ NL;
        }
    "};" ++ NL(2);
}
end("DATATYPES");

-(NL);

begin("SERVICES");
for service in model.services {
    "class " ++ service.name ++ " {" ++ NL;
    for handler in service.handlers {
        IND ++ handler.return_type.unwrap_or("void") ++
        " " ++ handler.name ++ "(";
        
        for argument in handler.arguments {
            argument.typ.join("::") ++ " " ++ argument.name
        }

        ") = 0;" ++ NL;
    }
    NL ++ "};" ++ NL(2);
}
end("SERVICES");

"}" ++ NL
